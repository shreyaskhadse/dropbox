# Load the required packages
library(dplyr)
library(ggplot2)

# Set the random seed for reproducibility
set.seed(123)

# Generate a random dataset with unclean data
num_rows <- 1000

# Generate random values for variables
var1 <- rnorm(num_rows, mean = 50, sd = 10)
var2 <- runif(num_rows, min = 0, max = 100)
var3 <- rpois(num_rows, lambda = 5)

# Introduce NA values randomly in each variable
num_na_per_var <- 50  # Number of NA values to introduce per variable
var1[sample(num_rows, num_na_per_var)] <- NA
var2[sample(num_rows, num_na_per_var)] <- NA
var3[sample(num_rows, num_na_per_var)] <- NA

# Create the dataset
dataset <- data.frame(var1, var2, var3)

# Perform data cleaning task (e.g., impute missing values, remove outliers)
# This task can be assigned to the intern

# Perform Monte Carlo simulation
num_iterations <- 1000

simulation_results <- list()

for (i in 1:num_iterations) {
  # Perform any computations or analysis on the cleaned dataset
  # For example, let's calculate the mean of var1 for each iteration
  iteration_mean <- mean(dataset$var1, na.rm = TRUE)
  
  # Store the result of each iteration in the simulation_results list
  simulation_results[[i]] <- iteration_mean
}

# Create ggplot visualization of the simulation results
sim_results_df <- data.frame(iteration = 1:num_iterations, mean_var1 = unlist(simulation_results))

ggplot(sim_results_df, aes(x = iteration, y = mean_var1)) +
  geom_line() +
  labs(x = "Iteration", y = "Mean var1") +
  ggtitle("Monte Carlo Simulation: Mean var1 by Iteration")
